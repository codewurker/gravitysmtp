"use strict";(self.webpackChunkgravitysmtp=self.webpackChunkgravitysmtp||[]).push([[3846,877,1050],{907:function(e,t,n){n.r(t);var r=n(6796),i=n(9801),a=n(5720),o=n(5210),c=n(9509),l=n.n(c),s=n(9608),u=n.n(s),d=n(7784),v=n(4070),p=n(583),g=n(4237),f=n(6192),m=n(5721),_=n(2472),b=n(7024),y=n(8887),h=n(8424),w=n(2077),O=n(9208),E=n(141);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=d.React.forwardRef,P=d.React.useEffect,R=d.React.useRef,S=d.ReactRouter.useLocation,C=d.ReactRouter.useNavigate,Z=d.ReactRouter.useSearchParams,j="log_page",I="search_term",T={},A=new URLSearchParams(window.location.search),L=A.get(j)||"1",N=A.get(I)||"",G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,n=void 0===t?1:t,r=e.searchTerm,i=void 0===r?"":r,a="page-".concat(n);return i&&(a+="-".concat(i)),a},B=k((function(e,t){var n,a=e.customAttributes,c=void 0===a?{}:a,s=e.customClasses,D=void 0===s?[]:s,k=e.common,A=void 0===k?{}:k,B=e.data,H=void 0===B?{}:B,J=e.i18n,F=void 0===J?{}:J,V=S(),M=C(),U=(0,E.default)((function(e){return e.setConfirmDialogOpen})),z=(0,E.default)((function(e){return e.setConfirmDialogSettings})),q=(0,E.default)((function(e){return e.setDeleteEventDialogOpen})),W=(0,E.default)((function(e){return e.setDeletingEventId})),$=(0,E.default)((function(e){return e.setDataGridLoading})),K=(0,E.default)((function(e){return e.setLogDetail})),Q=(0,E.default)((function(e){return e.setViewEmailDialogOpen})),X=(0,E.default)((function(e){return e.setViewEmailEventProperties})),Y=(0,E.default)((function(e){return e.dataGridLoading})),ee=(0,E.default)((function(e){return e.dataGridRows})),te=(0,E.default)((function(e){return e.dataGridRowCount})),ne=(0,E.default)((function(e){return e.setDataGridRowCount})),re=(0,E.default)((function(e){return e.setDataGridRows})),ie=Z(),ae=(0,o.Z)(ie,2),oe=ae[0],ce=(ae[1],R()),le=R(""),se=x({className:(0,d.classnames)({"gravitysmtp-activity-log-app__email-log":!0},D)},c),ue=H.ajax_grid_pagination_url,de=void 0===ue?"":ue,ve=H.base_url,pe=void 0===ve?"":ve,ge=H.data_grid,fe=void 0===ge?{}:ge,me=fe.bulk_actions_options,_e=void 0===me?[]:me,be=fe.columns,ye=void 0===be?[]:be,he=fe.column_style_props,we=void 0===he?{}:he,Oe=H.initial_load_timestamp,Ee=void 0===Oe?"":Oe,De=H.initial_row_count,xe=void 0===De?0:De,ke=H.rows_per_page,Pe=void 0===ke?7:ke,Re=F.confirm_bulk_delete_heading,Se=void 0===Re?"":Re,Ce=F.confirm_bulk_delete_content,Ze=void 0===Ce?"":Ce,je=F.data_grid,Ie=void 0===je?{}:je,Te=Ie.clear_search_aria_label,Ae=void 0===Te?"":Te,Le=Ie.empty_message,Ne=void 0===Le?"":Le,Ge=Ie.empty_title,Be=void 0===Ge?"":Ge,He=Ie.top_heading,Je=void 0===He?"":He,Fe=Ie.top_content,Ve=void 0===Fe?"":Fe,Me=Ie.grid_heading,Ue=void 0===Me?"":Me,ze=Ie.grid_controls_bulk_actions_select_label,qe=void 0===ze?"":ze,We=Ie.grid_controls_bulk_actions_button_label,$e=void 0===We?"":We,Ke=Ie.grid_controls_search_placeholder,Qe=void 0===Ke?"":Ke,Xe=Ie.grid_controls_search_button_label,Ye=void 0===Xe?"":Xe,et=Ie.pagination_next,tt=void 0===et?"":et,nt=Ie.pagination_prev,rt=void 0===nt?"":nt,it=Ie.pagination_next_aria_label,at=void 0===it?"":it,ot=Ie.pagination_prev_aria_label,ct=void 0===ot?"":ot,lt=Ie.search_no_results_title,st=void 0===lt?"":lt,ut=Ie.search_no_results_message,dt=void 0===ut?"":ut,vt=Ie.select_notice_selected_number_entries,pt=void 0===vt?"":vt,gt=Ie.select_notice_selected_all_number_entries,ft=void 0===gt?"":gt,mt=Ie.select_notice_select_all_number_entries,_t=void 0===mt?"":mt,bt=Ie.select_notice_clear_selection,yt=void 0===bt?"":bt,ht=F.debug_messages,wt=void 0===ht?{}:ht,Ot=wt.deleting_activity_log_rows,Et=void 0===Ot?"":Ot,Dt=wt.deleting_activity_log_rows_error,xt=void 0===Dt?"":Dt,kt=wt.fetching_activity_log_page,Pt=void 0===kt?"":kt,Rt=wt.fetching_activity_log_page_error,St=void 0===Rt?"":Rt,Ct=wt.fetching_single_activity_log,Zt=void 0===Ct?"":Ct,jt=wt.fetching_single_activity_log_error,It=void 0===jt?"":jt,Tt=A.data,At=(void 0===Tt?{}:Tt).test_mode,Lt=void 0!==At&&At,Nt=A.i18n,Gt=void 0===Nt?{}:Nt,Bt=Gt.snackbar_activity_log_delete_error,Ht=void 0===Bt?"":Bt,Jt=Gt.snackbar_email_log_error,Ft=void 0===Jt?"":Jt,Vt=Gt.snackbar_email_log_detail_empty_error,Mt=void 0===Vt?"":Vt,Ut=Gt.snackbar_email_log_detail_generic_error,zt=void 0===Ut?"":Ut,qt=Gt.test_mode_warning_notice,Wt=void 0===qt?"":qt,$t=A.endpoints,Kt=void 0===$t?{}:$t,Qt=Kt.activity_log_page,Xt=void 0===Qt?{}:Qt,Yt=Xt.action,en=void 0===Yt?"":Yt,tn=Xt.nonce,nn=void 0===tn?"":tn,rn=Kt.delete_events,an=void 0===rn?{}:rn,on=an.action,cn=void 0===on?"":on,ln=an.nonce,sn=void 0===ln?"":ln,un=Kt.get_single_email,dn=void 0===un?{}:un,vn=dn.action,pn=void 0===vn?"":vn,gn=dn.nonce,fn=void 0===gn?"":gn,mn=(null==H?void 0:H.caps)||{},_n=(0,g.Ds)(),bn=G({page:L,searchTerm:N});T[bn]={},T[bn].rows=(null==H||null===(n=H.data_grid)||void 0===n?void 0:n.data)||[],T[bn].newRowCount=xe;var yn=function(){le.current=""};P((function(){return window.addEventListener("popstate",yn),function(){window.removeEventListener("popstate",yn)}}),[]);var hn=function(){var e=(0,i.Z)(l().mark((function e(t){var n,r,i,a,o,c,s,d,g;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"preview"===t.action&&Q(!0),n={action:pn,security:fn,event_id:t.data.event_id},e.next=4,(0,w.Z)((0,p.gB)(Zt,JSON.stringify((0,O.Z)(["security"],n))),"info");case 4:return e.prev=4,e.next=7,(0,v.v_)({endpoint:u(),body:n});case 7:if(null==(i=e.sent)||null===(r=i.data)||void 0===r||!r.success){e.next=16;break}if(o=null==i||null===(a=i.data)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.log_detail,(!Array.isArray(o)||o.length)&&o){e.next=13;break}return _n(Mt,"error"),e.abrupt("return");case 13:"preview"===t.action?X({date:o.date,isHtml:o.is_html,id:o.log_id,fromHash:o.fromHash,from:o.from,to:o.to,title:o.subject}):(K((null==i||null===(c=i.data)||void 0===c||null===(c=c.data)||void 0===c?void 0:c.log_detail)||{}),s=new URLSearchParams(V.search),d=H.nav_item_param_key||"tab",s.set(d,"log-details"),s.set("event_id",t.data.event_id),g=x(x({},V),{},{search:"?".concat(s.toString())}),M(g,{state:{previous:"activity-log"}})),e.next=18;break;case 16:"preview"===t.action&&Q(!1),_n(zt,"error");case 18:e.next=25;break;case 20:return e.prev=20,e.t0=e.catch(4),_n(e.t0,"error"),e.next=25,(0,w.Z)((0,p.gB)(It,JSON.stringify(e.t0)),"error");case 25:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(t){return e.apply(this,arguments)}}(),wn=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q(!0),W(t.data.event_id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),On=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("view"!==t.action&&"preview"!==t.action){e.next=5;break}return e.next=3,hn(t);case 3:e.next=8;break;case 5:if("delete"!==t.action){e.next=8;break}return e.next=8,wn(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();P((function(){if(ce.current){var e=oe.get(j)||"1",t=oe.get(I)||"";Dn({nextSelectedPage:parseInt(e,10)-1,searchTerm:t},!0)}else ce.current=!0}),[oe]);var En=function(e){var t=e.page,n=e.searchTerm,r=void 0===n?"":n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new URLSearchParams(V.search);a.set(j,t),r?a.set(I,r):a.delete(I),M("?".concat(a.toString()),{replace:i})},Dn=function(){var e=(0,i.Z)(l().mark((function e(t){var n,r,i,a,o,c,s,u,d,g,f=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],r=G({page:t.nextSelectedPage+1}),t.searchTerm||!T[r]){e.next=8;break}return re(T[r].rows),ne(parseInt(T[r].newRowCount,10)),En({page:t.nextSelectedPage+1},n),le.current="",e.abrupt("return",t.nextSelectedPage);case 8:if(i={action:en,security:nn,max_date:Ee,requested_page:t.nextSelectedPage+1,search_term:t.searchTerm||""},(a=JSON.stringify(i))!==le.current){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,(0,w.Z)((0,p.gB)(Pt,JSON.stringify((0,O.Z)(["security"],i))),"info");case 14:return e.prev=14,e.next=17,(0,v.v_)({endpoint:de,body:i});case 17:if(u=e.sent,d=(null==u||null===(o=u.data)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.rows)||[],g=(null==u||null===(c=u.data)||void 0===c||null===(c=c.data)||void 0===c?void 0:c.total)||"0",null==u||null===(s=u.data)||void 0===s||!s.success){e.next=27;break}return t.searchTerm||(T[r]={rows:d,newRowCount:g}),re(d),ne(parseInt(g,10)),En({page:t.nextSelectedPage+1,searchTerm:t.searchTerm||""},n),le.current=a,e.abrupt("return",t.nextSelectedPage);case 27:_n(Ft,"error"),e.next=35;break;case 30:return e.prev=30,e.t0=e.catch(14),_n(e.t0,"error"),e.next=35,(0,w.Z)((0,p.gB)(St,JSON.stringify(e.t0)),"error");case 35:case"end":return e.stop()}}),e,null,[[14,30]])})));return function(t){return e.apply(this,arguments)}}(),xn=function(){var e=(0,i.Z)(l().mark((function e(t,n){var r,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={action:cn,security:sn,event_ids:t,all_events:n?"1":"0",max_date:Ee},e.next=3,(0,w.Z)((0,p.gB)(Et,JSON.stringify((0,O.Z)(["security"],r))),"info");case 3:return e.prev=3,e.next=6,(0,v.v_)({endpoint:u(),body:r});case 6:null!=(a=e.sent)&&null!==(i=a.data)&&void 0!==i&&i.success?window.location.href=pe:(_n(Ht,"error"),$(!1)),e.next=16;break;case 10:return e.prev=10,e.t0=e.catch(3),_n(Ht,"error"),$(!1),e.next=16,(0,w.Z)((0,p.gB)(xt,JSON.stringify(e.t0)),"error");case 16:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),kn=function(){var e=(0,i.Z)(l().mark((function e(t,n,r){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"delete"===t&&z({confirmDialogI18n:{confirm_change_heading:Se,confirm_change_content:Ze.replace("%1$s",String(r?te.toLocaleString():n.length))},confirmDialogOnCancel:function(){return U(!1)},confirmDialogOnConfirm:function(){var e=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(!1),$(!0),e.next=4,xn(n,r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),confirmDialogOpen:!0});case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Pn=ee.length>0,Rn={bulkActionSelectAttributes:{labelAttributes:{label:qe,isVisible:!1},options:_e},bulkActionButtonAttributes:{label:$e},bulkActionHandler:kn,customClasses:["gravitysmtp-activity-log-app__activity-log-table"],id:"gravitysmtp-activity-log-app__activity-log-table",data:ee,columns:ye,columnStyleProps:we,dataPerPage:Pn?Pe:7,EmptyImage:m.Z,emptyMessageAttributes:{style:{maxWidth:"362px"}},handleGridClicks:On,hasBulkActions:!0,hasFilters:!1,hasSearch:!0,i18n:{emptyMessageI18n:Ne,emptyTitleI18n:Be,gridHeadingI18n:Ue,searchNoResultsTitleI18n:st,searchNoResultsMessageI18n:dt,selectNoticeSelectedNumberEntriesI18n:pt,selectNoticeSelectedAllNumberEntriesI18n:ft,selectNoticeSelectAllNumberEntriesI18n:_t,selectNoticeClearSelectionI18n:yt},isLoading:Y,maintainHeight:!Pn,page:parseInt(oe.get(j)||"1",10)-1,paginationAttributes:{nextLabel:tt,nextAriaLabel:at,onClick:Dn,pageCount:Math.ceil(te/Pe),previousLabel:rt,previousAriaLabel:ct},rowCount:te,searchButtonAttributes:{label:Ye},searchInputAttributes:{clearableButtonAttributes:{ariaLabel:Ae,icon:"x-circle",iconPrefix:"gravitysmtp-admin-icon"},placeholder:Qe},SearchNoResultsImage:_.Z,searchTerm:oe.get(I)||"",useAjax:!0};return mn.gravitysmtp_view_email_log&&d.React.createElement("div",(0,r.Z)({},se,{ref:t}),d.React.createElement(f.Z,{size:"display-sm",weight:"semibold",spacing:1,content:Je}),d.React.createElement(b.Z,{size:"text-sm",spacing:6,color:"comet",content:Ve}),Lt&&d.React.createElement(y.Z,{customIconPrefix:"gravitysmtp-admin-icon",spacing:[6,0,6,0],type:"notice"},Wt),d.React.createElement("div",{className:"gravitysmtp-activity-log-app__wrapper"},d.React.createElement(h.Z,Rn)))}));B.propTypes={customAttributes:d.PropTypes.object,customClasses:d.PropTypes.oneOfType([d.PropTypes.string,d.PropTypes.array,d.PropTypes.object])},B.displayName="ActivityLogScreen",t.default=B},141:function(e,t,n){n.r(t);var r,i,a,o,c=n(5720),l=n(3267),s=n.n(l),u=n(760);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=(null===(r=(0,n(583).iE)(s(),"gravitysmtp_admin_config"))||void 0===r||null===(r=r.components)||void 0===r?void 0:r.activity_log)||{},g={confirmDialogConfirmButtonType:"primary-new",confirmDialogI18n:{},confirmDialogOnCancel:function(){},confirmDialogOnConfirm:function(){},confirmDialogOpen:!1,logDetail:(null==p||null===(i=p.data)||void 0===i?void 0:i.log_detail)||{},dataGridLoading:!1,dataGridRows:(null==p||null===(a=p.data)||void 0===a||null===(a=a.data_grid)||void 0===a?void 0:a.data)||[],dataGridRowCount:parseInt((null==p||null===(o=p.data)||void 0===o?void 0:o.initial_row_count)||0,10),deleteEventDialogOpen:!1,deletingEventId:0,viewEmailDialogOpen:!1,viewEmailEventId:0,viewEmailEventIsHtml:!1,viewEmailEventDate:"",viewEmailEventFromHash:"",viewEmailEventFrom:"",viewEmailEventTo:"",viewEmailEventTitle:""},f=(0,u.Ue)(g,(function(e){return{deleteEventLog:function(t){return e((function(e){return v(v({},e),{},{dataGridRows:e.dataGridRows.filter((function(e){var n;return(null==e||null===(n=e.subject)||void 0===n||null===(n=n.props)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.event_id)!==t}))})}))},setConfirmDialogOpen:function(t){return e((function(){return{confirmDialogOpen:t}}))},setConfirmDialogSettings:function(t){var n=t.confirmDialogConfirmButtonType,r=void 0===n?"primary-new":n,i=t.confirmDialogI18n,a=void 0===i?{}:i,o=t.confirmDialogOpen,c=void 0!==o&&o,l=t.confirmDialogOnCancel,s=void 0===l?function(){}:l,u=t.confirmDialogOnConfirm,d=void 0===u?function(){}:u;e((function(){return{confirmDialogConfirmButtonType:r,confirmDialogI18n:a,confirmDialogOpen:c,confirmDialogOnCancel:s,confirmDialogOnConfirm:d}}))},setDataGridLoading:function(t){return e({dataGridLoading:t})},setDataGridRows:function(t){return e((function(){return{dataGridRows:t}}))},setDataGridRowCount:function(t){return e({dataGridRowCount:t})},setDeleteEventDialogOpen:function(t){return e({deleteEventDialogOpen:t})},setDeletingEventId:function(t){return e({deletingEventId:t})},setLogDetail:function(t){return e({logDetail:t})},setViewEmailDialogOpen:function(t){return e({viewEmailDialogOpen:t})},setViewEmailEventProperties:function(t){return e({viewEmailEventId:t.id,viewEmailEventIsHtml:t.isHtml,viewEmailEventDate:t.date,viewEmailEventFromHash:t.fromHash,viewEmailEventFrom:t.from,viewEmailEventTo:t.to,viewEmailEventTitle:t.title})}}}));t.default=f},2077:function(e,t,n){n.d(t,{Z:function(){return p}});var r,i=n(9801),a=n(9509),o=n.n(a),c=n(9608),l=n.n(c),s=n(3267),u=n.n(s),d=n(4070),v=(null===(r=(0,n(583).iE)(u(),"gravitysmtp_admin_config"))||void 0===r?void 0:r.common)||{};function p(){return g.apply(this,arguments)}function g(){return g=(0,i.Z)(o().mark((function e(){var t,n,r,i,a,c,s,u,p,g,f=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>0&&void 0!==f[0]?f[0]:"",i=f.length>1&&void 0!==f[1]?f[1]:"debug",a=v.data,c=void 0===a?{}:a,s=v.endpoints,p=(null==(u=void 0===s?{}:s)||null===(t=u.log_debug_item)||void 0===t?void 0:t.action)||"",g=(null==u||null===(n=u.log_debug_item)||void 0===n?void 0:n.nonce)||"",null!=c&&c.debug_log_enabled&&p&&g&&r){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(0,d.v_)({endpoint:l(),body:{action:p,security:g,message:r,priority:i}}).catch((function(e){}));case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}},9208:function(e,t,n){var r=n(6588),i=n(5210);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return function n(a){return Object.entries(a).reduce((function(a,o){var c=(0,i.Z)(o,2),l=c[0],s=c[1];return"object"===(0,r.Z)(s)&&null!==s?a[l]=n(s):e.includes(l)?a[l]=null===s?null:t.repeat(s.length):a[l]=s,a}),Array.isArray(a)?[]:{})}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}}}]);