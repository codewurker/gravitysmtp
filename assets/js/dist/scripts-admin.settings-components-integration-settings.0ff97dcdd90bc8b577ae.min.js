"use strict";(self.webpackChunkgravitysmtp=self.webpackChunkgravitysmtp||[]).push([[5685],{3643:function(t,e,n){n.r(e);var i=n(6796),r=n(9801),o=n(5210),s=n(5720),a=n(9509),c=n.n(a),l=n(9608),u=n.n(l),p=n(7784),d=n(4070),g=n(375),v=n(8777),f=n(9805),m=n(7343),y=n(1480),b=n(4237),h=n(8957),_=n(7003),O=n(2077),S=n(9208),w=n(4582),k=n(7866);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var P=p.React.forwardRef,x=p.React.useState,Z=p.React.useRef,T=P((function(t,e){var n,a,l,P,T,R,C=t.customAttributes,D=void 0===C?{}:C,B=t.customClasses,E=void 0===B?[]:B,I=t.common,A=void 0===I?{}:I,L=t.data,z=void 0===L?{}:L,N=t.i18n,F=void 0===N?{}:N,H=(null==F?void 0:F.integrations)||{},J=H.integration_settings_apply,M=H.integration_settings_cancel,U=H.integration_settings_error,W=(null==A?void 0:A.i18n)||{},q=W.debug_messages,G=void 0===q?{}:q,K=G.saving_integration_settings,Q=void 0===K?"":K,V=G.saving_integration_settings_error,X=void 0===V?"":V,Y=W.snackbar_api_save_success,$=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){(0,s.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({className:(0,p.classnames)({"gravitysmtp-integration-settings":!0},E)},D),tt=(0,k.default)((function(t){return t.activeIntegrationSettings})),et=(0,k.default)((function(t){return t.integrationSettingsFormData})),nt=(0,k.default)((function(t){return t.integrationSettingsDialogOpen})),it=x(!1),rt=(0,o.Z)(it,2),ot=rt[0],st=rt[1],at=Z(null),ct=(0,k.default)((function(t){return t.setIntegrationSettingsDialogOpen})),lt=(0,k.default)((function(t){return t.updateIntegrationStatus})),ut=(0,k.default)((function(t){return t.setIntegrationSettingsFormData})),pt=(0,g.Bl)(z,"id",tt),dt=(null==pt||null===(n=pt.settings)||void 0===n?void 0:n.fields)||[],gt=(null==A||null===(a=A.endpoints)||void 0===a||null===(a=a.save_connector_settings)||void 0===a?void 0:a.action)||"",vt=(null==A||null===(l=A.endpoints)||void 0===l||null===(l=l.save_connector_settings)||void 0===l?void 0:l.nonce)||"",ft=(0,b.Ds)(),mt=(null==pt||null===(P=pt.settings)||void 0===P?void 0:P.hide_save)||!1,yt=function(){var t=(0,r.Z)(c().mark((function t(){var e,n,i,r,o,s,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null!=at&&at.current&&(e=at.current.offsetWidth,at.current.style.width="".concat(e,"px")),st(!0),n={action:gt,security:vt,settings:et[tt],connector_type:tt},t.next=5,(0,O.Z)((0,g.gB)(Q,tt,JSON.stringify((0,S.Z)(["api_key","server_api_token","password","security"],n))),"info");case 5:return t.prev=5,t.next=8,(0,d.v_)({endpoint:u(),body:n});case 8:null!=(r=t.sent)&&null!==(i=r.data)&&void 0!==i&&i.success?(ft(Y),lt(tt,{configured:!0}),(0,v.saveActivationState)(tt,gt,vt,{configured:!0}),setTimeout((function(){ct(!1)}),1e3)):(a=(0,g.sO)(null==r||null===(o=r.error)||void 0===o||null===(o=o.detail)||void 0===o?void 0:o.data)?JSON.parse(null==r||null===(s=r.error)||void 0===s||null===(s=s.detail)||void 0===s?void 0:s.data):"",ft((null==a?void 0:a.data)||U,"error")),t.next=17;break;case 12:return t.prev=12,t.t0=t.catch(5),t.next=16,(0,O.Z)((0,g.gB)(X,tt,JSON.stringify(t.t0)),"error");case 16:case 17:st(!1),null!=at&&at.current&&(at.current.style.width="");case 19:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(){return t.apply(this,arguments)}}(),bt={closeButtonType:"simplified",customCloseButtonLabelAttributes:{className:(0,p.classnames)({"gform-button__icon":!0,"gravitysmtp-admin-icon":!0,"gravitysmtp-admin-icon--x":!0})},customMaskClasses:["gravitysmtp-integration-settings__mask"],description:null==pt||null===(T=pt.settings)||void 0===T?void 0:T.description,isOpen:nt,maskTheme:"light",maxHeight:"calc(90vh - 80px)",mode:"modal",onClose:function(){if(new URLSearchParams(window.location.search).has("integration")){var t=new URL(window.location.href),e=new URLSearchParams(t.search);e.delete("integration"),t.search=e.toString(),window.history.pushState({path:t.toString()},"",t.toString())}ct(!1)},padContent:!1,position:"absolute",simplebar:!0,theme:"cosmos",title:null==pt||null===(R=pt.settings)||void 0===R?void 0:R.title,titleSize:"md",titleTagName:"h3",version:2},ht=(0,p.classnames)({"gravitysmtp-integration-settings__save":!0,"gravitysmtp-integration-settings__save--saving":ot}),_t=(0,_.Z)(dt,{activeIntegrationSettings:tt,integrationSettingsFormData:et,saveConnectorSettings:yt,savingSettings:ot,Svgs:w,i18n:null==A?void 0:A.i18n,addSnackBarMessage:ft});return p.React.createElement("div",(0,i.Z)({},$,{ref:e}),p.React.createElement(y.Z,bt,p.React.createElement("form",{id:tt},p.React.createElement(h.Z,{id:tt,fields:_t,setFieldData:function(t,e){return ut(tt,t,e)}})),p.React.createElement(f.Z,{customClasses:["gravitysmtp-integration-settings__actions"],display:"flex",spacing:[8,0,0,0]},p.React.createElement(m.Z,{label:M,onClick:function(){return ct(!1)},size:"size-height-m",type:"white"}),!mt&&p.React.createElement(m.Z,{active:ot,activeType:"loader",customClasses:ht,icon:"save-disk",iconPosition:"leading",iconPrefix:"gravitysmtp-admin-icon",label:J,onClick:yt,ref:at,spacing:[0,0,0,3],size:"size-height-m"}))))}));T.propTypes={customAttributes:p.PropTypes.object,customClasses:p.PropTypes.oneOfType([p.PropTypes.string,p.PropTypes.array,p.PropTypes.object]),common:p.PropTypes.object,data:p.PropTypes.object,i18n:p.PropTypes.object},T.displayName="IntegrationSettings",e.default=T},7003:function(t,e,n){var i=n(9801),r=n(5720),o=n(9509),s=n.n(o),a=n(7784),c=n(5489),l=n(8731),u=n(6901),p=n(6493),d=n(375),g=n(760);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!["microsoft","google"].includes(e.activeIntegrationSettings))return t;var n=e.integrationSettingsFormData[e.activeIntegrationSettings],r=t.map((function(t){if(!["BrandedButton","BrandedLink","CopyInput","LinkedHelpTextInput"].includes(t.component)||!t.external)return t;var r,o=e.i18n.snackbar_url_copied,v=void 0===o?"":o,m=e.Svgs[t.props.Svg],y=null,b={};switch(t.component){case"BrandedButton":y=c.Z,b=f(f({},t.props),{},{disabled:!(null!=n&&n.client_id&&null!=n&&n.client_secret)||e.savingSettings,onClick:(r=(0,i.Z)(s().mark((function t(i){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.preventDefault(),t.next=3,e.saveConnectorSettings();case 3:window.location.href="".concat(n.oauth_url,"?client_id=").concat(n.client_id).concat(n.oauth_params);case 4:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)}),Svg:a.React.createElement(m,null)});break;case"BrandedLink":y=l.Z,b=f(f({},t.props),{},{href:"wizard"===e.context?t.wizardHref:t.props.href,Svg:a.React.createElement(m,null)});break;case"CopyInput":y=p.Z,b=f(f({},t.props),{},{actionButtonAttributes:f(f({},t.props.actionButtonAttributes),{},{onClick:function(t,n){e.addSnackBarMessage(v),(0,d.BR)(n)}})});break;case"LinkedHelpTextInput":y=p.Z,b=f(f({},t.props),{},{helpTextAttributes:f(f({},t.props.helpTextAttributes),{},{content:a.React.createElement(g.ji,{openingSymbol:"{{",closingSymbol:"}}",text:t.props.helpTextAttributes.content,tokens:t.links.map((function(t){return{component:u.Z,key:t.key,props:t.props}}))})})})}return f(f({},t),{},{component:y,props:b})}));return r}}}]);