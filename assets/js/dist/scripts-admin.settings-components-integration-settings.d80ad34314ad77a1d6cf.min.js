"use strict";(self.webpackChunkgravitysmtp=self.webpackChunkgravitysmtp||[]).push([[5685],{3643:function(t,e,n){n.r(e);var i=n(6796),s=n(9801),r=n(5210),a=n(5720),o=n(9509),c=n.n(o),l=n(9608),u=n.n(l),d=n(7784),g=n(4070),p=n(583),v=n(8777),m=n(9805),f=n(7343),y=n(1480),h=n(4237),_=n(8957),b=n(2077),O=n(9208),w=n(7866);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var P=d.React.forwardRef,k=d.React.useState,j=d.React.useRef,R=P((function(t,e){var n,o,l,P,R,T,C=t.customAttributes,Z=void 0===C?{}:C,x=t.customClasses,D=void 0===x?[]:x,E=t.common,N=void 0===E?{}:E,z=t.data,B=void 0===z?{}:z,I=t.i18n,A=void 0===I?{}:I,L=(null==A?void 0:A.integrations)||{},F=L.integration_settings_apply,J=L.integration_settings_cancel,U=L.integration_settings_error,H=(null==N?void 0:N.i18n)||{},M=H.debug_messages,W=void 0===M?{}:M,q=W.saving_integration_settings,G=void 0===q?"":q,K=W.saving_integration_settings_error,Q=void 0===K?"":K,V=H.snackbar_api_save_success,X=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({className:(0,d.classnames)({"gravitysmtp-integration-settings":!0},D)},Z),Y=(0,w.default)((function(t){return t.activeIntegrationSettings})),$=(0,w.default)((function(t){return t.integrationSettingsFormData})),tt=(0,w.default)((function(t){return t.integrationSettingsDialogOpen})),et=k(!1),nt=(0,r.Z)(et,2),it=nt[0],st=nt[1],rt=j(null),at=(0,w.default)((function(t){return t.setIntegrationSettingsDialogOpen})),ot=(0,w.default)((function(t){return t.updateIntegrationStatus})),ct=(0,w.default)((function(t){return t.setIntegrationSettingsFormData})),lt=(0,p.Bl)(B,"id",Y),ut=(null==lt||null===(n=lt.settings)||void 0===n?void 0:n.fields)||[],dt=(null==N||null===(o=N.endpoints)||void 0===o||null===(o=o.save_connector_settings)||void 0===o?void 0:o.action)||"",gt=(null==N||null===(l=N.endpoints)||void 0===l||null===(l=l.save_connector_settings)||void 0===l?void 0:l.nonce)||"",pt=(0,h.Ds)(),vt=(null==lt||null===(P=lt.settings)||void 0===P?void 0:P.hide_save)||!1,mt=function(){var t=(0,s.Z)(c().mark((function t(){var e,n,i,s,r,a,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=rt.current.offsetWidth,rt.current.style.width="".concat(e,"px"),st(!0),n={action:dt,security:gt,settings:$[Y],connector_type:Y},t.next=6,(0,b.Z)((0,p.gB)(G,Y,JSON.stringify((0,O.Z)(["api_key","server_api_token","password","security"],n))),"info");case 6:return t.prev=6,t.next=9,(0,g.v_)({endpoint:u(),body:n});case 9:null!=(s=t.sent)&&null!==(i=s.data)&&void 0!==i&&i.success?(pt(V),ot(Y,{configured:!0}),(0,v.saveActivationState)(Y,dt,gt,{configured:!0}),setTimeout((function(){at(!1)}),1e3)):(o=(0,p.sO)(null==s||null===(r=s.error)||void 0===r||null===(r=r.detail)||void 0===r?void 0:r.data)?JSON.parse(null==s||null===(a=s.error)||void 0===a||null===(a=a.detail)||void 0===a?void 0:a.data):"",pt((null==o?void 0:o.data)||U,"error")),t.next=18;break;case 13:return t.prev=13,t.t0=t.catch(6),t.next=17,(0,b.Z)((0,p.gB)(Q,Y,JSON.stringify(t.t0)),"error");case 17:case 18:st(!1),rt.current&&(rt.current.style.width="");case 20:case"end":return t.stop()}}),t,null,[[6,13]])})));return function(){return t.apply(this,arguments)}}(),ft=["gravitysmtp-integration-settings__mask"];vt&&ft.push("gravitysmtp-integration-settings__mask--hide-save");var yt={closeButtonType:"simplified",customCloseButtonLabelAttributes:{className:(0,d.classnames)({"gform-button__icon":!0,"gravitysmtp-admin-icon":!0,"gravitysmtp-admin-icon--x":!0})},customMaskClasses:ft,description:null==lt||null===(R=lt.settings)||void 0===R?void 0:R.description,isOpen:tt,maskTheme:"light",maxHeight:"calc(90vh - 80px)",mode:"modal",onClose:function(){if(new URLSearchParams(window.location.search).has("integration")){var t=new URL(window.location.href),e=new URLSearchParams(t.search);e.delete("integration"),t.search=e.toString(),window.history.pushState({path:t.toString()},"",t.toString())}at(!1)},padContent:!1,position:"absolute",simplebar:!0,theme:"cosmos",title:null==lt||null===(T=lt.settings)||void 0===T?void 0:T.title,titleSize:"md",titleTagName:"h3",version:2},ht=(0,d.classnames)({"gravitysmtp-integration-settings__save":!0,"gravitysmtp-integration-settings__save--saving":it});return d.React.createElement("div",(0,i.Z)({},X,{ref:e}),d.React.createElement(y.Z,yt,d.React.createElement("form",{id:Y},d.React.createElement(_.Z,{id:Y,fields:ut,setFieldData:function(t,e){return ct(Y,t,e)}})),d.React.createElement(m.Z,{customClasses:["gravitysmtp-integration-settings__actions"],display:"flex",spacing:[8,0,0,0]},d.React.createElement(f.Z,{label:J,onClick:function(){return at(!1)},size:"size-height-m",spacing:[0,3,0,0],type:"white"}),d.React.createElement(f.Z,{active:it,activeType:"loader",customClasses:ht,icon:"save-disk",iconPosition:"leading",iconPrefix:"gravitysmtp-admin-icon",label:F,onClick:mt,ref:rt,size:"size-height-m"}))))}));R.propTypes={customAttributes:d.PropTypes.object,customClasses:d.PropTypes.oneOfType([d.PropTypes.string,d.PropTypes.array,d.PropTypes.object]),common:d.PropTypes.object,data:d.PropTypes.object,i18n:d.PropTypes.object},R.displayName="IntegrationSettings",e.default=R}}]);