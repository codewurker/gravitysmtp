"use strict";(self.webpackChunkgravitysmtp=self.webpackChunkgravitysmtp||[]).push([[5491,2668],{43645:function(e,t,n){n.r(t);var r=n(71860),a=n(88856),o=n(90455),i=n(8140),u=n(78564),l=n.n(u),s=n(97867),c=n(60177),d=n(71376),g=n(84860),p=n(5529),v=n(96343),b=n(76910),_=n(83391),f=n(80529),m=n(83707),h=n(93313),y=n(52014);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var D=s.React.forwardRef,A=s.React.useEffect,P=s.React.useRef,R=s.React.useState,O=s.ReactRouter.useLocation,j=s.ReactRouter.useNavigate,x=s.ReactRouter.useSearchParams,T="log_page",L="search_term",k={},S=new URLSearchParams(window.location.search),C=S.get(T)||"1",E=S.get(L)||"",I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,n=void 0===t?1:t,r=e.searchTerm,a=void 0===r?"":r,o="page-".concat(n);return a&&(o+="-".concat(a)),o},N=D((function(e,t){var n,u=e.customAttributes,D=void 0===u?{}:u,S=e.customClasses,N=void 0===S?[]:S,G=e.common,z=void 0===G?{}:G,J=e.data,M=void 0===J?{}:J,H=e.i18n,U=void 0===H?{}:H,q=z.endpoints,B=(void 0===q?{}:q).debug_log_page,K=B.action,F=void 0===K?"":K,Q=B.nonce,V=void 0===Q?"":Q,W=U||{},X=W.debug_log,Y=void 0===X?{}:X,Z=Y.top_heading,$=void 0===Z?"":Z,ee=Y.data_grid,te=void 0===ee?{}:ee,ne=te.top_heading,re=void 0===ne?"":ne,ae=te.clear_search_aria_label,oe=void 0===ae?"":ae,ie=te.empty_title,ue=void 0===ie?"":ie,le=te.empty_message,se=void 0===le?"":le,ce=te.grid_controls_search_button_label,de=void 0===ce?"":ce,ge=te.grid_controls_search_placeholder,pe=void 0===ge?"":ge,ve=te.pagination_next,be=void 0===ve?"":ve,_e=te.pagination_prev,fe=void 0===_e?"":_e,me=te.pagination_next_aria_label,he=void 0===me?"":me,ye=te.pagination_prev_aria_label,we=void 0===ye?"":ye,De=te.search_no_results_title,Ae=void 0===De?"":De,Pe=te.search_no_results_message,Re=void 0===Pe?"":Pe,Oe=Y.snackbar_debug_log_error,je=void 0===Oe?"":Oe,xe=W.debug_messages,Te=void 0===xe?{}:xe,Le=Te.fetching_debug_log_page,ke=void 0===Le?"":Le,Se=Te.fetching_debug_log_page_error,Ce=void 0===Se?"":Se,Ee=(null==M?void 0:M.debug_log)||{},Ie=Ee.ajax_grid_pagination_url,Ne=void 0===Ie?"":Ie,Ge=Ee.data_grid,ze=void 0===Ge?{}:Ge,Je=ze.columns,Me=void 0===Je?[]:Je,He=ze.column_style_props,Ue=void 0===He?{}:He,qe=Ee.initial_load_timestamp,Be=void 0===qe?"":qe,Ke=Ee.initial_row_count,Fe=void 0===Ke?0:Ke,Qe=Ee.rows_per_page,Ve=void 0===Qe?7:Qe,We=(null==M?void 0:M.caps)||{},Xe=O(),Ye=j(),Ze=(0,g.dh)(),$e=R(Fe),et=(0,i.A)($e,2),tt=et[0],nt=et[1],rt=x(),at=(0,i.A)(rt,2),ot=at[0],it=(at[1],(0,y.default)((function(e){return e.debugLogDataGridRows}))),ut=(0,y.default)((function(e){return e.setDebugLogDataGridRows})),lt=(0,y.default)((function(e){return e.setDebugDetailsDialogData})),st=(0,y.default)((function(e){return e.setDebugDetailsDialogOpen})),ct=P(),dt=P("");A((function(){if(ct.current){var e=ot.get(T)||"1",t=ot.get(L)||"";bt({currentPage:parseInt(e,10)-1,searchTerm:t},!0)}else ct.current=!0}),[ot]),A((function(){return window.addEventListener("popstate",pt),function(){window.removeEventListener("popstate",pt)}}),[]);var gt=I({page:C,searchTerm:E});k[gt]={},k[gt].rows=(null==M||null===(n=M.debug_log)||void 0===n||null===(n=n.data_grid)||void 0===n?void 0:n.data)||[],k[gt].newRowCount=Fe;var pt=function(){dt.current=""},vt=function(e){var t=e.page,n=e.searchTerm,r=void 0===n?"":n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new URLSearchParams(Xe.search);o.set(T,t),r?o.set(L,r):o.delete(L),Ye("?".concat(o.toString()),{replace:a})},bt=function(){var e=(0,o.A)(l().mark((function e(t){var n,r,a,o,i,u,s,g,p,v,b=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=b.length>1&&void 0!==b[1]&&b[1],r=I({page:t.currentPage+1}),t.searchTerm||!k[r]){e.next=8;break}return ut(k[r].rows),nt(parseInt(k[r].newRowCount,10)),vt({page:t.currentPage+1},n),dt.current="",e.abrupt("return",t.currentPage);case 8:if(a={action:F,security:V,max_date:Be,requested_page:t.currentPage+1,search_term:t.searchTerm||""},(o=JSON.stringify(a))!==dt.current){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,(0,m.A)((0,d.nv)(ke,JSON.stringify((0,h.A)(["security"],a))),"info");case 14:return e.prev=14,e.next=17,(0,c.bE)({endpoint:Ne,body:a});case 17:if(g=e.sent,p=(null==g||null===(i=g.data)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.rows)||[],v=(null==g||null===(u=g.data)||void 0===u||null===(u=u.data)||void 0===u?void 0:u.total)||"0",null==g||null===(s=g.data)||void 0===s||!s.success){e.next=27;break}return t.searchTerm||(k[r]={rows:p,newRowCount:v}),ut(p),nt(parseInt(v,10)),vt({page:t.currentPage+1,searchTerm:t.searchTerm||""},n),dt.current=o,e.abrupt("return",t.currentPage);case 27:Ze(je,"error"),e.next=35;break;case 30:return e.prev=30,e.t0=e.catch(14),Ze(e.t0,"error"),e.next=35,(0,m.A)((0,d.nv)(Ce,JSON.stringify(e.t0)),"error");case 35:case"end":return e.stop()}}),e,null,[[14,30]])})));return function(t){return e.apply(this,arguments)}}(),_t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({className:(0,s.classnames)({"gravitysmtp-tools-app__debug-log":!0},N)},D),ft=it.length>0,mt={customClasses:["gravitysmtp-tools-app__debug-log-table"],id:"gravitysmtp-tools-app__debug-log-table",columns:Me,columnStyleProps:Ue,data:it,dataPerPage:ft?Ve:7,EmptyImage:v.A,handleGridClicks:function(e){if("view"===e.action){var t,n,r,a,o=(null==e||null===(t=e.data)||void 0===t?void 0:t.id)||0,i=it.filter((function(e){var t;return(null==e||null===(t=e.id)||void 0===t||null===(t=t.props)||void 0===t?void 0:t.content)===o}))[0];if(!i)return;lt({date:(null==i||null===(n=i.date)||void 0===n||null===(n=n.props)||void 0===n?void 0:n.content)||"",event:(null==i||null===(r=i.status)||void 0===r?void 0:r.props)||{},log:(null==i||null===(a=i.log)||void 0===a||null===(a=a.props)||void 0===a?void 0:a.label)||""}),st(!0)}},i18n:{emptyMessageI18n:se,emptyTitleI18n:ue,gridHeadingI18n:re},maintainHeight:!ft,modules:[f.dK,f.vj],moduleAttributes:{pagination:{nextLabel:be,nextAriaLabel:he,onClick:bt,page:parseInt(ot.get(T)||"1",10)-1,pageCount:Math.ceil(tt/Ve),previousLabel:fe,previousAriaLabel:we},search:{button:{customAttributes:{"data-test-id":"debug-log-search-trigger"},label:de},input:{customAttributes:{"data-test-id":"debug-log-search-input"},clearableButtonAttributes:{ariaLabel:oe,icon:"x-circle",iconPrefix:"gravitysmtp-admin-icon"},placeholder:pe,value:ot.get(L)||""},noResults:{Image:b.A},i18n:{searchNoResultsTitleI18n:Ae,searchNoResultsMessageI18n:Re},onSearch:bt}},titleAttributes:{tagName:"h2"},useAjax:!0};return We.gravitysmtp_view_debug_log&&s.React.createElement("div",(0,r.A)({},_t,{ref:t}),s.React.createElement(p.A,{size:"display-sm",weight:"semibold",spacing:6,content:$}),s.React.createElement(_.A,mt))}));N.propTypes={customAttributes:s.PropTypes.object,customClasses:s.PropTypes.oneOfType([s.PropTypes.string,s.PropTypes.array,s.PropTypes.object]),data:s.PropTypes.object,i18n:s.PropTypes.object},N.displayName="DebugLogScreen",t.default=N},52014:function(e,t,n){n.r(t);var r,a,o=n(40450),i=n.n(o),u=n(13296),l=(null===(r=(0,n(71376).zj)(i(),"gravitysmtp_admin_config"))||void 0===r||null===(r=r.components)||void 0===r?void 0:r.tools)||{},s={debugLogDataGridRows:(null==l||null===(a=l.data)||void 0===a||null===(a=a.debug_log)||void 0===a||null===(a=a.data_grid)||void 0===a?void 0:a.data)||[],debugDetailsDialogData:{},debugDetailsDialogOpen:!1},c=(0,u.vt)(s,(function(e){return{setDebugLogDataGridRows:function(t){return e((function(){return{debugLogDataGridRows:t}}))},setDebugDetailsDialogData:function(t){return e((function(){return{debugDetailsDialogData:t}}))},setDebugDetailsDialogOpen:function(t){return e((function(){return{debugDetailsDialogOpen:t}}))}}}));t.default=c},83707:function(e,t,n){n.d(t,{A:function(){return p}});var r,a=n(90455),o=n(78564),i=n.n(o),u=n(27122),l=n.n(u),s=n(40450),c=n.n(s),d=n(60177),g=(null===(r=(0,n(71376).zj)(c(),"gravitysmtp_admin_config"))||void 0===r?void 0:r.common)||{};function p(){return v.apply(this,arguments)}function v(){return v=(0,a.A)(i().mark((function e(){var t,n,r,a,o,u,s,c,p,v,b=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.length>0&&void 0!==b[0]?b[0]:"",a=b.length>1&&void 0!==b[1]?b[1]:"debug",o=g.data,u=void 0===o?{}:o,s=g.endpoints,p=(null==(c=void 0===s?{}:s)||null===(t=c.log_debug_item)||void 0===t?void 0:t.action)||"",v=(null==c||null===(n=c.log_debug_item)||void 0===n?void 0:n.nonce)||"",null!=u&&u.debug_log_enabled&&p&&v&&r){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(0,d.bE)({endpoint:l(),body:{action:p,security:v,message:r,priority:a}}).catch((function(e){}));case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}},93313:function(e,t,n){var r=n(52888),a=n(8140);t.A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return function n(o){return Object.entries(o).reduce((function(o,i){var u=(0,a.A)(i,2),l=u[0],s=u[1];return"object"===(0,r.A)(s)&&null!==s?o[l]=n(s):e.includes(l)?o[l]=null===s?null:t.repeat(s.length):o[l]=s,o}),Array.isArray(o)?[]:{})}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}}}]);