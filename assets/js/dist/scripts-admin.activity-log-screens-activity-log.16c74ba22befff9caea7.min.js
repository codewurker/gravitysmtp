"use strict";(self.webpackChunkgravitysmtp=self.webpackChunkgravitysmtp||[]).push([[3846,877,1050],{907:function(e,t,n){n.r(t);var r=n(6796),i=n(9801),a=n(5720),o=n(5210),c=n(9509),l=n.n(c),s=n(9608),u=n.n(s),d=n(7784),v=n(4070),p=n(583),g=n(4237),f=n(6192),m=n(5721),_=n(2472),b=n(7024),y=n(8424),h=n(2077),w=n(9208),O=n(141);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=d.React.forwardRef,k=d.React.useEffect,P=d.React.useRef,R=d.ReactRouter.useLocation,S=d.ReactRouter.useNavigate,C=d.ReactRouter.useSearchParams,j="log_page",Z="search_term",I={},T=new URLSearchParams(window.location.search),A=T.get(j)||"1",L=T.get(Z)||"",N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,n=void 0===t?1:t,r=e.searchTerm,i=void 0===r?"":r,a="page-".concat(n);return i&&(a+="-".concat(i)),a},G=x((function(e,t){var n,a=e.customAttributes,c=void 0===a?{}:a,s=e.customClasses,E=void 0===s?[]:s,x=e.common,T=void 0===x?{}:x,G=e.data,B=void 0===G?{}:G,H=e.i18n,J=void 0===H?{}:H,F=R(),V=S(),M=(0,O.default)((function(e){return e.setConfirmDialogOpen})),U=(0,O.default)((function(e){return e.setConfirmDialogSettings})),z=(0,O.default)((function(e){return e.setDeleteEventDialogOpen})),q=(0,O.default)((function(e){return e.setDeletingEventId})),W=(0,O.default)((function(e){return e.setDataGridLoading})),$=(0,O.default)((function(e){return e.setLogDetail})),K=(0,O.default)((function(e){return e.setViewEmailDialogOpen})),Q=(0,O.default)((function(e){return e.setViewEmailEventProperties})),X=(0,O.default)((function(e){return e.dataGridLoading})),Y=(0,O.default)((function(e){return e.dataGridRows})),ee=(0,O.default)((function(e){return e.dataGridRowCount})),te=(0,O.default)((function(e){return e.setDataGridRowCount})),ne=(0,O.default)((function(e){return e.setDataGridRows})),re=C(),ie=(0,o.Z)(re,2),ae=ie[0],oe=(ie[1],P()),ce=P(""),le=D({className:(0,d.classnames)({"gravitysmtp-activity-log-app__email-log":!0},E)},c),se=B.ajax_grid_pagination_url,ue=void 0===se?"":se,de=B.base_url,ve=void 0===de?"":de,pe=B.data_grid,ge=void 0===pe?{}:pe,fe=ge.bulk_actions_options,me=void 0===fe?[]:fe,_e=ge.columns,be=void 0===_e?[]:_e,ye=ge.column_style_props,he=void 0===ye?{}:ye,we=B.initial_load_timestamp,Oe=void 0===we?"":we,Ee=B.initial_row_count,De=void 0===Ee?0:Ee,xe=B.rows_per_page,ke=void 0===xe?7:xe,Pe=J.confirm_bulk_delete_heading,Re=void 0===Pe?"":Pe,Se=J.confirm_bulk_delete_content,Ce=void 0===Se?"":Se,je=J.data_grid,Ze=void 0===je?{}:je,Ie=Ze.clear_search_aria_label,Te=void 0===Ie?"":Ie,Ae=Ze.empty_message,Le=void 0===Ae?"":Ae,Ne=Ze.empty_title,Ge=void 0===Ne?"":Ne,Be=Ze.top_heading,He=void 0===Be?"":Be,Je=Ze.top_content,Fe=void 0===Je?"":Je,Ve=Ze.grid_heading,Me=void 0===Ve?"":Ve,Ue=Ze.grid_controls_bulk_actions_select_label,ze=void 0===Ue?"":Ue,qe=Ze.grid_controls_bulk_actions_button_label,We=void 0===qe?"":qe,$e=Ze.grid_controls_search_placeholder,Ke=void 0===$e?"":$e,Qe=Ze.grid_controls_search_button_label,Xe=void 0===Qe?"":Qe,Ye=Ze.pagination_next,et=void 0===Ye?"":Ye,tt=Ze.pagination_prev,nt=void 0===tt?"":tt,rt=Ze.pagination_next_aria_label,it=void 0===rt?"":rt,at=Ze.pagination_prev_aria_label,ot=void 0===at?"":at,ct=Ze.search_no_results_title,lt=void 0===ct?"":ct,st=Ze.search_no_results_message,ut=void 0===st?"":st,dt=Ze.select_notice_selected_number_entries,vt=void 0===dt?"":dt,pt=Ze.select_notice_selected_all_number_entries,gt=void 0===pt?"":pt,ft=Ze.select_notice_select_all_number_entries,mt=void 0===ft?"":ft,_t=Ze.select_notice_clear_selection,bt=void 0===_t?"":_t,yt=J.debug_messages,ht=void 0===yt?{}:yt,wt=ht.deleting_activity_log_rows,Ot=void 0===wt?"":wt,Et=ht.deleting_activity_log_rows_error,Dt=void 0===Et?"":Et,xt=ht.fetching_activity_log_page,kt=void 0===xt?"":xt,Pt=ht.fetching_activity_log_page_error,Rt=void 0===Pt?"":Pt,St=ht.fetching_single_activity_log,Ct=void 0===St?"":St,jt=ht.fetching_single_activity_log_error,Zt=void 0===jt?"":jt,It=T.i18n,Tt=void 0===It?{}:It,At=Tt.snackbar_activity_log_delete_error,Lt=void 0===At?"":At,Nt=Tt.snackbar_email_log_error,Gt=void 0===Nt?"":Nt,Bt=Tt.snackbar_email_log_detail_empty_error,Ht=void 0===Bt?"":Bt,Jt=Tt.snackbar_email_log_detail_generic_error,Ft=void 0===Jt?"":Jt,Vt=T.endpoints,Mt=void 0===Vt?{}:Vt,Ut=Mt.activity_log_page,zt=void 0===Ut?{}:Ut,qt=zt.action,Wt=void 0===qt?"":qt,$t=zt.nonce,Kt=void 0===$t?"":$t,Qt=Mt.delete_events,Xt=void 0===Qt?{}:Qt,Yt=Xt.action,en=void 0===Yt?"":Yt,tn=Xt.nonce,nn=void 0===tn?"":tn,rn=Mt.get_single_email,an=void 0===rn?{}:rn,on=an.action,cn=void 0===on?"":on,ln=an.nonce,sn=void 0===ln?"":ln,un=(null==B?void 0:B.caps)||{},dn=(0,g.Ds)(),vn=N({page:A,searchTerm:L});I[vn]={},I[vn].rows=(null==B||null===(n=B.data_grid)||void 0===n?void 0:n.data)||[],I[vn].newRowCount=De;var pn=function(){ce.current=""};k((function(){return window.addEventListener("popstate",pn),function(){window.removeEventListener("popstate",pn)}}),[]);var gn=function(){var e=(0,i.Z)(l().mark((function e(t){var n,r,i,a,o,c,s,d,g;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"preview"===t.action&&K(!0),n={action:cn,security:sn,event_id:t.data.event_id},e.next=4,(0,h.Z)((0,p.gB)(Ct,JSON.stringify((0,w.Z)(["security"],n))),"info");case 4:return e.prev=4,e.next=7,(0,v.v_)({endpoint:u(),body:n});case 7:if(null==(i=e.sent)||null===(r=i.data)||void 0===r||!r.success){e.next=16;break}if(o=null==i||null===(a=i.data)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.log_detail,(!Array.isArray(o)||o.length)&&o){e.next=13;break}return dn(Ht,"error"),e.abrupt("return");case 13:"preview"===t.action?Q({date:o.date,isHtml:o.is_html,id:o.log_id,fromHash:o.fromHash,from:o.from,to:o.to,title:o.subject}):($((null==i||null===(c=i.data)||void 0===c||null===(c=c.data)||void 0===c?void 0:c.log_detail)||{}),s=new URLSearchParams(F.search),d=B.nav_item_param_key||"tab",s.set(d,"log-details"),s.set("event_id",t.data.event_id),g=D(D({},F),{},{search:"?".concat(s.toString())}),V(g,{state:{previous:"activity-log"}})),e.next=18;break;case 16:"preview"===t.action&&K(!1),dn(Ft,"error");case 18:e.next=25;break;case 20:return e.prev=20,e.t0=e.catch(4),dn(e.t0,"error"),e.next=25,(0,h.Z)((0,p.gB)(Zt,JSON.stringify(e.t0)),"error");case 25:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(t){return e.apply(this,arguments)}}(),fn=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:z(!0),q(t.data.event_id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mn=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("view"!==t.action&&"preview"!==t.action){e.next=5;break}return e.next=3,gn(t);case 3:e.next=8;break;case 5:if("delete"!==t.action){e.next=8;break}return e.next=8,fn(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();k((function(){if(oe.current){var e=ae.get(j)||"1",t=ae.get(Z)||"";bn({nextSelectedPage:parseInt(e,10)-1,searchTerm:t},!0)}else oe.current=!0}),[ae]);var _n=function(e){var t=e.page,n=e.searchTerm,r=void 0===n?"":n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new URLSearchParams(F.search);a.set(j,t),r?a.set(Z,r):a.delete(Z),V("?".concat(a.toString()),{replace:i})},bn=function(){var e=(0,i.Z)(l().mark((function e(t){var n,r,i,a,o,c,s,u,d,g,f=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],r=N({page:t.nextSelectedPage+1}),t.searchTerm||!I[r]){e.next=8;break}return ne(I[r].rows),te(parseInt(I[r].newRowCount,10)),_n({page:t.nextSelectedPage+1},n),ce.current="",e.abrupt("return",t.nextSelectedPage);case 8:if(i={action:Wt,security:Kt,max_date:Oe,requested_page:t.nextSelectedPage+1,search_term:t.searchTerm||""},(a=JSON.stringify(i))!==ce.current){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,(0,h.Z)((0,p.gB)(kt,JSON.stringify((0,w.Z)(["security"],i))),"info");case 14:return e.prev=14,e.next=17,(0,v.v_)({endpoint:ue,body:i});case 17:if(u=e.sent,d=(null==u||null===(o=u.data)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.rows)||[],g=(null==u||null===(c=u.data)||void 0===c||null===(c=c.data)||void 0===c?void 0:c.total)||"0",null==u||null===(s=u.data)||void 0===s||!s.success){e.next=27;break}return t.searchTerm||(I[r]={rows:d,newRowCount:g}),ne(d),te(parseInt(g,10)),_n({page:t.nextSelectedPage+1,searchTerm:t.searchTerm||""},n),ce.current=a,e.abrupt("return",t.nextSelectedPage);case 27:dn(Gt,"error"),e.next=35;break;case 30:return e.prev=30,e.t0=e.catch(14),dn(e.t0,"error"),e.next=35,(0,h.Z)((0,p.gB)(Rt,JSON.stringify(e.t0)),"error");case 35:case"end":return e.stop()}}),e,null,[[14,30]])})));return function(t){return e.apply(this,arguments)}}(),yn=function(){var e=(0,i.Z)(l().mark((function e(t,n){var r,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={action:en,security:nn,event_ids:t,all_events:n?"1":"0",max_date:Oe},e.next=3,(0,h.Z)((0,p.gB)(Ot,JSON.stringify((0,w.Z)(["security"],r))),"info");case 3:return e.prev=3,e.next=6,(0,v.v_)({endpoint:u(),body:r});case 6:null!=(a=e.sent)&&null!==(i=a.data)&&void 0!==i&&i.success?window.location.href=ve:(dn(Lt,"error"),W(!1)),e.next=16;break;case 10:return e.prev=10,e.t0=e.catch(3),dn(Lt,"error"),W(!1),e.next=16,(0,h.Z)((0,p.gB)(Dt,JSON.stringify(e.t0)),"error");case 16:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),hn=function(){var e=(0,i.Z)(l().mark((function e(t,n,r){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"delete"===t&&U({confirmDialogI18n:{confirm_change_heading:Re,confirm_change_content:Ce.replace("%1$s",String(r?ee.toLocaleString():n.length))},confirmDialogOnCancel:function(){return M(!1)},confirmDialogOnConfirm:function(){var e=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(!1),W(!0),e.next=4,yn(n,r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),confirmDialogOpen:!0});case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),wn=Y.length>0,On={bulkActionSelectAttributes:{labelAttributes:{label:ze,isVisible:!1},options:me},bulkActionButtonAttributes:{label:We},bulkActionHandler:hn,customClasses:["gravitysmtp-activity-log-app__activity-log-table"],id:"gravitysmtp-activity-log-app__activity-log-table",data:Y,columns:be,columnStyleProps:he,dataPerPage:wn?ke:7,EmptyImage:m.Z,emptyMessageAttributes:{style:{maxWidth:"362px"}},handleGridClicks:mn,hasBulkActions:!0,hasFilters:!1,hasSearch:!0,i18n:{emptyMessageI18n:Le,emptyTitleI18n:Ge,gridHeadingI18n:Me,searchNoResultsTitleI18n:lt,searchNoResultsMessageI18n:ut,selectNoticeSelectedNumberEntriesI18n:vt,selectNoticeSelectedAllNumberEntriesI18n:gt,selectNoticeSelectAllNumberEntriesI18n:mt,selectNoticeClearSelectionI18n:bt},isLoading:X,maintainHeight:!wn,page:parseInt(ae.get(j)||"1",10)-1,paginationAttributes:{nextLabel:et,nextAriaLabel:it,onClick:bn,pageCount:Math.ceil(ee/ke),previousLabel:nt,previousAriaLabel:ot},rowCount:ee,searchButtonAttributes:{label:Xe},searchInputAttributes:{clearableButtonAttributes:{ariaLabel:Te,icon:"x-circle",iconPrefix:"gravitysmtp-admin-icon"},placeholder:Ke},SearchNoResultsImage:_.Z,searchTerm:ae.get(Z)||"",useAjax:!0};return un.gravitysmtp_view_email_log&&d.React.createElement("div",(0,r.Z)({},le,{ref:t}),d.React.createElement(f.Z,{size:"display-sm",weight:"semibold",spacing:1,content:He}),d.React.createElement(b.Z,{size:"text-sm",spacing:6,color:"comet",content:Fe}),d.React.createElement("div",{className:"gravitysmtp-activity-log-app__wrapper"},d.React.createElement(y.Z,On)))}));G.propTypes={customAttributes:d.PropTypes.object,customClasses:d.PropTypes.oneOfType([d.PropTypes.string,d.PropTypes.array,d.PropTypes.object])},G.displayName="ActivityLogScreen",t.default=G},141:function(e,t,n){n.r(t);var r,i,a,o,c=n(5720),l=n(3267),s=n.n(l),u=n(760);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=(null===(r=(0,n(583).iE)(s(),"gravitysmtp_admin_config"))||void 0===r||null===(r=r.components)||void 0===r?void 0:r.activity_log)||{},g={confirmDialogConfirmButtonType:"primary-new",confirmDialogI18n:{},confirmDialogOnCancel:function(){},confirmDialogOnConfirm:function(){},confirmDialogOpen:!1,logDetail:(null==p||null===(i=p.data)||void 0===i?void 0:i.log_detail)||{},dataGridLoading:!1,dataGridRows:(null==p||null===(a=p.data)||void 0===a||null===(a=a.data_grid)||void 0===a?void 0:a.data)||[],dataGridRowCount:parseInt((null==p||null===(o=p.data)||void 0===o?void 0:o.initial_row_count)||0,10),deleteEventDialogOpen:!1,deletingEventId:0,viewEmailDialogOpen:!1,viewEmailEventId:0,viewEmailEventIsHtml:!1,viewEmailEventDate:"",viewEmailEventFromHash:"",viewEmailEventFrom:"",viewEmailEventTo:"",viewEmailEventTitle:""},f=(0,u.Ue)(g,(function(e){return{deleteEventLog:function(t){return e((function(e){return v(v({},e),{},{dataGridRows:e.dataGridRows.filter((function(e){var n;return(null==e||null===(n=e.subject)||void 0===n||null===(n=n.props)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.event_id)!==t}))})}))},setConfirmDialogOpen:function(t){return e((function(){return{confirmDialogOpen:t}}))},setConfirmDialogSettings:function(t){var n=t.confirmDialogConfirmButtonType,r=void 0===n?"primary-new":n,i=t.confirmDialogI18n,a=void 0===i?{}:i,o=t.confirmDialogOpen,c=void 0!==o&&o,l=t.confirmDialogOnCancel,s=void 0===l?function(){}:l,u=t.confirmDialogOnConfirm,d=void 0===u?function(){}:u;e((function(){return{confirmDialogConfirmButtonType:r,confirmDialogI18n:a,confirmDialogOpen:c,confirmDialogOnCancel:s,confirmDialogOnConfirm:d}}))},setDataGridLoading:function(t){return e({dataGridLoading:t})},setDataGridRows:function(t){return e((function(){return{dataGridRows:t}}))},setDataGridRowCount:function(t){return e({dataGridRowCount:t})},setDeleteEventDialogOpen:function(t){return e({deleteEventDialogOpen:t})},setDeletingEventId:function(t){return e({deletingEventId:t})},setLogDetail:function(t){return e({logDetail:t})},setViewEmailDialogOpen:function(t){return e({viewEmailDialogOpen:t})},setViewEmailEventProperties:function(t){return e({viewEmailEventId:t.id,viewEmailEventIsHtml:t.isHtml,viewEmailEventDate:t.date,viewEmailEventFromHash:t.fromHash,viewEmailEventFrom:t.from,viewEmailEventTo:t.to,viewEmailEventTitle:t.title})}}}));t.default=f},2077:function(e,t,n){n.d(t,{Z:function(){return p}});var r,i=n(9801),a=n(9509),o=n.n(a),c=n(9608),l=n.n(c),s=n(3267),u=n.n(s),d=n(4070),v=(null===(r=(0,n(583).iE)(u(),"gravitysmtp_admin_config"))||void 0===r?void 0:r.common)||{};function p(){return g.apply(this,arguments)}function g(){return g=(0,i.Z)(o().mark((function e(){var t,n,r,i,a,c,s,u,p,g,f=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>0&&void 0!==f[0]?f[0]:"",i=f.length>1&&void 0!==f[1]?f[1]:"debug",a=v.data,c=void 0===a?{}:a,s=v.endpoints,p=(null==(u=void 0===s?{}:s)||null===(t=u.log_debug_item)||void 0===t?void 0:t.action)||"",g=(null==u||null===(n=u.log_debug_item)||void 0===n?void 0:n.nonce)||"",null!=c&&c.debug_log_enabled&&p&&g&&r){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(0,d.v_)({endpoint:l(),body:{action:p,security:g,message:r,priority:i}}).catch((function(e){}));case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}},9208:function(e,t,n){var r=n(6588),i=n(5210);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return function n(a){return Object.entries(a).reduce((function(a,o){var c=(0,i.Z)(o,2),l=c[0],s=c[1];return"object"===(0,r.Z)(s)&&null!==s?a[l]=n(s):e.includes(l)?a[l]=null===s?null:t.repeat(s.length):a[l]=s,a}),Array.isArray(a)?[]:{})}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}}}]);